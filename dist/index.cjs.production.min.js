"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("fast-xml-parser");const e=/^\d+/,r=/\d+$/,n=/(\(|\[)(.+)(\)|\])/;function s(t){const s=(t=t.trim()).replace(e,"").replace(n,"").replace(r,"").trim(),o=t.match(e),i=t.match(n),a=t.match(r);return{name:s,amount:o?parseInt(o[0]):void 0,set:i?i[2]:void 0,collectors:a?parseInt(a[0]):void 0}}function o(t){var e;return[t.amount||1,t.name,null!==(e=t.set)&&void 0!==e&&e.length?`(${t.set})`:void 0,t.collectors].filter((t=>null!=t&&t)).join(" ")}function i(t){var e,r;let n=[];return t.commander&&(n.push("Commander"),n.push(t.commander.toCardString()),n.push("")),t.companion&&(n.push("Companion"),n.push(t.companion.toCardString()),n.push("")),null!==(e=t.deck)&&void 0!==e&&e.length&&(n.push("Deck"),t.deck.forEach((t=>{n.push(t.toCardString())})),n.push("")),null!==(r=t.sideboard)&&void 0!==r&&r.length&&(n.push("Sideboard"),t.sideboard.forEach((t=>{n.push(t.toCardString())})),n.push("")),n.join("\n")}class a{constructor(t){const{amount:e,name:r,set:n,collectors:s,mtgoID:o}="string"==typeof t?this.parseString(t):this.parseObject(t);this.name=r,this.amount=e,this.set=n,this.collectors=s,this.mtgoID=o}parseString(t){return s(t)}parseObject(t){return{name:t.Name,amount:parseInt(t.Quantity),mtgoID:t.CatID}}toCardString(){return o(this)}}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class d{constructor(){c(this,"valid",!1),c(this,"deck",[]),c(this,"sideboard",[]),c(this,"companion",null),c(this,"commander",null)}toDeckListString(){return i(this)}}var u;!function(t){t[t.unstarted=0]="unstarted",t[t.commander=1]="commander",t[t.companion=2]="companion",t[t.deck=3]="deck",t[t.sideboard=4]="sideboard"}(u||(u={}));const h=/^deck$/i,l=/^sideboard$/i,m=/^commander$/i,p=/^companion$/i,g=/\n/g;class f extends d{constructor(t){super();let e=t.toString().trim().split(g),r=0;try{e.forEach((t=>{if((t=t.trim()).match(m))r=1;else if(t.match(p))r=2;else if(t.match(h))r=3;else{if(0===r&&t.length>0)r=3;else{if(t.match(l)||3===r&&0===t.length)return void(r=4);if(0===t.length)return}switch(r){case 1:this.commander=new a(t);break;case 2:this.companion=new a(t);break;case 3:this.deck.push(new a(t));break;case 4:this.sideboard.push(new a(t))}}})),this.valid=!0}catch(t){this.valid=!1,console.error(t)}}}class b extends d{constructor(e,r=!0){super(),e=e.toString().trim();const n=t.validate(e);this.valid=!0===n,this.valid?t.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1}).Deck.Cards.forEach((t=>{"16777728"===t.Annotation?this.commander=new a(t):"true"===t.Sideboard?this.sideboard.push(new a(t)):this.deck.push(new a(t))})):r&&console.error(n.err)}}function v(t){const e=new b(t,!1);return e.valid?e:new f(t)}exports.CardModel=a,exports.Decklist=f,exports.MTGO=b,exports.autoParse=v,exports.default=v,exports.parseString=s,exports.toCardString=o,exports.toDeckListString=i;
//# sourceMappingURL=index.cjs.production.min.js.map
