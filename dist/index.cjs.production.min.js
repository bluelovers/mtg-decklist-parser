"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("fast-xml-parser");const e=/^\d+/,r=/\d+$/,n=/(\(|\[)(.+)(\)|\])/;function o(t){const o=(t=t.trim()).replace(e,"").replace(n,"").replace(r,"").trim(),s=t.match(e),i=t.match(n),a=t.match(r);return{name:o,amount:s?parseInt(s[0]):void 0,set:i?i[2]:void 0,collectors:a?parseInt(a[0]):void 0}}function s(t){return[t.amount||1,i(t)].filter((t=>null!=t&&t)).join(" ")}function i(t){var e;return[t.name,null!==(e=t.set)&&void 0!==e&&e.length?`(${t.set})`:void 0,t.collectors].filter((t=>null!=t&&t)).join(" ")}function a(t){var e,r;let n=[];return t.commander&&(n.push("Commander"),n.push(t.commander.toCardString()),n.push("")),t.companion&&(n.push("Companion"),n.push(t.companion.toCardString()),n.push("")),null!==(e=t.deck)&&void 0!==e&&e.length&&(n.push("Deck"),t.deck.forEach((t=>{n.push(t.toCardString())})),n.push("")),null!==(r=t.sideboard)&&void 0!==r&&r.length&&(n.push("Sideboard"),t.sideboard.forEach((t=>{n.push(t.toCardString())})),n.push("")),n.join("\n")}class c{constructor(t){const{amount:e,name:r,set:n,collectors:o,mtgoID:s}="string"==typeof t?this.parseString(t):this.parseObject(t);this.name=r,this.amount=e,this.set=n,this.collectors=o,this.mtgoID=s}parseString(t){return o(t)}parseObject(t){return{name:t.Name,amount:parseInt(t.Quantity),mtgoID:t.CatID}}toCardString(){return s(this)}}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class u{constructor(){d(this,"valid",!1),d(this,"deck",[]),d(this,"sideboard",[]),d(this,"companion",null),d(this,"commander",null)}toDeckListString(){return a(this)}}var l;!function(t){t[t.unstarted=0]="unstarted",t[t.commander=1]="commander",t[t.companion=2]="companion",t[t.deck=3]="deck",t[t.sideboard=4]="sideboard"}(l||(l={}));const h=/^deck$/i,m=/^sideboard$/i,p=/^commander$/i,g=/^companion$/i,f=/\n/g;class b extends u{constructor(t){super();let e=t.toString().trim().split(f),r=0;try{e.forEach((t=>{if((t=t.trim()).match(p))r=1;else if(t.match(g))r=2;else if(t.match(h))r=3;else{if(0===r&&t.length>0)r=3;else{if(t.match(m)||3===r&&0===t.length)return void(r=4);if(0===t.length)return}switch(r){case 1:this.commander=new c(t);break;case 2:this.companion=new c(t);break;case 3:this.deck.push(new c(t));break;case 4:this.sideboard.push(new c(t))}}})),this.valid=!0}catch(t){this.valid=!1,console.error(t)}}}class v extends u{constructor(e,r=!0){super(),e=e.toString().trim();const n=t.validate(e);this.valid=!0===n,this.valid?t.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1}).Deck.Cards.forEach((t=>{"16777728"===t.Annotation?this.commander=new c(t):"true"===t.Sideboard?this.sideboard.push(new c(t)):this.deck.push(new c(t))})):r&&console.error(n.err)}}function k(t){const e=new v(t,!1);return e.valid?e:new b(t)}exports.CardModel=c,exports.Decklist=b,exports.MTGO=v,exports.autoParse=k,exports.default=k,exports.parseString=o,exports.toCardString=s,exports.toCardStringWithoutAmount=i,exports.toDeckListString=a;
//# sourceMappingURL=index.cjs.production.min.js.map
